{% extends "layout.jinja2" %}

{#
<!-- {% block pagestyles %}
  {% assets "home_less_bundle" %}
    <link href="{{ ASSET_URL }}" rel="stylesheet" type="text/css">
  {% endassets %}
{% endblock %} -->
#}

{% block content %}
  {% set active_category = "directory" -%}
  {% set active_page = "serach" -%}
  {% set sub_active_page = '' -%}
  {% include "navigation.jinja2" %}

    <div class="row">
      <h1>{{ title }}</h1>
    </div>

    {# <div class="row">
        <div class="card border-info mb-3"  >

          <div class="card-header">Notes:</div>
          <div class="card-body">
              <p class="card-text">Currently uses "N/A" for gauges which were sourced from scraping the website vs onchain. 
              Mostly refered to as "Core". These pools do not show on the table below due to lack of creation blocktime.
              </p>
              <p class="card-text">Currently there is not a record of all deployments.
              </p>
              <p class="card-text">Rows with a <strong>Vote Timestamp</strong> have been whitelisted by governance to recieve CRV issuance as determined by gauge vote.
              </p>
          </div>
        </div>

    </div> #}
{% include 'search_widget.jinja2' %}
 <div class="row">
    <p></p>
    <h4 class="text-info">Gauges</h4>
    {# <p class="text-{{table_tag}}">Not all gauge factories are currently covered, so this data is incomplete</p> #}

    <div id='gauges_table' ></div>
</div>
 <div class="row">
    <p></p>
    <h4 class="text-info">Ecosystem Participants</h4>
    {# <p class="text-{{table_tag}}">Not all gauge factories are currently covered, so this data is incomplete</p> #}

    <div id='roles_table' ></div>
</div>



<script type='text/javascript'>
      new gridjs.Grid({
        columns: [
            { id: 'known_as', name: 'Known As' ,            
            },
            { id: 'address', name: 'Address' ,
                formatter: (_, row) => gridjs.html(
                `${row.cells[1].data.toString()}`
                )               
            },
            { id: 'curve_vecrv_locker', name: 'veCRV Locker' } ,   
            { id: 'curve_voters', name: 'veCRV Voter' } ,   
            { id: 'convex_snapshot_voter', name: 'vlCVX Voter' } ,   
            { id: 'convex_delegate', name: 'vlCVX Delegate' } ,   
            { id: 'convex_delegator', name: 'vlCVX Delegator' } ,   
            { id: 'convex_vlcvx_locker', name: 'vlCVX Locker' } ,   
            { id: 'stakedao_snapshot_voter', name: 'sdCRV Voter' } ,   
            { id: 'stakedao_delegate', name: 'sdCRV Delegate' } ,   
            { id: 'stakedao_delegator', name: 'sdCRV Delegator' } , 
            { id: 'stakedao_sdcrv_staker', name: 'sdCRV Staker' } ,   
            { id: 'stakedao_vesdt_locker', name: 'veSDT Locker' } ,
        ],
        data: [
          {% for index, row in roles.iterrows() %}
            {
                'known_as': '{{ row['known_as'] }}',
                'address': `<a href={{ url_for('address_book_bp.show_roles', actor_addr = row['address']) }}>{{row['address']}}</a>`,
                'curve_vecrv_locker': '{{ row['curve_vecrv_locker']| string }}',
                'curve_voters': '{{ row['curve_voters']| string }}',
                'convex_snapshot_voter': '{{ row['convex_snapshot_voter']| string }}',
                'convex_delegate': '{{ row['convex_delegate']| string }}',
                'convex_delegator': '{{ row['convex_delegator']| string }}',
                'convex_vlcvx_locker': '{{ row['convex_vlcvx_locker']| string }}',
                'stakedao_snapshot_voter': '{{ row['stakedao_snapshot_voter']| string }}',
                'stakedao_delegate': '{{ row['stakedao_delegate']| string }}',
                'stakedao_delegator': '{{ row['stakedao_delegator']| string }}',
                'stakedao_sdcrv_staker': '{{ row['stakedao_sdcrv_staker']| string }}',
                'stakedao_vesdt_locker': '{{ row['stakedao_vesdt_locker']| string }}',


            },
          {% endfor %}
        ],
        {% with max_size = 5 %}
            {% include 'table_format_helper.jinja2' %}
        {% endwith %}
      }).render(document.getElementById('roles_table'));
</script>

<script type='text/javascript'>
      new gridjs.Grid({
        columns: [
            { id: 'gauge_name', name: 'Gauge Name' ,            
            },
            { id: 'gauge_addr', name: 'Gauge Address' ,
                formatter: (_, row) => gridjs.html(
                `${row.cells[1].data.toString()}`
                )               
            },
            { id: 'pool_addr', name: 'Pool Address',
                formatter: (_, row) => gridjs.html(
                    `${row.cells[2].data.toString()}`
                )
            },
            { id: 'vecrv_votes', name: 'veCRV Votes' } ,   
            { id: 'curve_liquidity', name: 'Liquidity Tracked' } ,   
            { id: 'convex_snapshot', name: 'vlCVX Snapshot' } ,   
            { id: 'stakedao_snapshot', name: 'sdCRV Snapshot' } ,   
            {# { id: 'df_votium', name: 'Votium V1' } ,    #}
            { id: 'votium_v2', name: 'Votium V2' } ,   
        ],
        data: [
          {% for index, row in gauges.iterrows() %}
            {
                'gauge_name': '{{ row['gauge_name'] }}',
                'gauge_addr': `<a href={{ url_for('gauges_bp.show', gauge_addr = row['gauge_addr']) }}>{{row['gauge_addr']}}</a>`,
                'pool_addr': `<a href={{ url_for('curve_liquidity_bp.show', gauge_addr = row['gauge_addr']) }}>{{row['pool_addr']}}</a>`,

                'vecrv_votes': '{{ row['vecrv_votes']| string }}',
                'curve_liquidity': '{{ row['curve_liquidity']| string }}',
                'convex_snapshot': '{{ row['convex_snapshot']| string }}',
                'stakedao_snapshot': '{{ row['stakedao_snapshot']| string }}',
                {# 'df_votium': '{{ row['df_votium']| string }}', #}
                'votium_v2': '{{ row['votium_v2']| string }}',

            },
          {% endfor %}
        ],
        {% with max_size = 5 %}
            {% include 'table_format_helper.jinja2' %}
        {% endwith %}
      }).render(document.getElementById('gauges_table'));
</script>


{% endblock %}
